{"componentChunkName":"component---src-templates-blog-post-js","path":"/casperjs/","result":{"data":{"site":{"siteMetadata":{"title":"XWARTZ","author":"xwartz"}},"markdownRemark":{"id":"8c164ff7-bace-5301-83d8-f299fc2e9d8b","html":"<p>è¿™æ˜¯ä¸€ç¯‡ä½¿ç”¨ CasperJS çš„ä¸€äº›ç»éªŒè®°å½•ï¼Œåç»­æœ‰é‡åˆ°å‘ï¼Œæˆ–è€…ä»€ä¹ˆä½¿ç”¨å¿ƒå¾—å°±ç»§ç»­æ›´æ–°åˆ°è¿™é‡Œäº†ã€‚</p>\n<hr>\n<p>å†™è¿‡å‰ç«¯å•å…ƒæµ‹è¯•çš„æœ‹å‹ï¼Œåº”è¯¥éƒ½çŸ¥é“ PhantomJSï¼Œæˆ‘ä¹‹å‰ä¹Ÿå†™è¿‡å‡ ç¯‡<a href=\"https://github.com/xwartz/blog\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">å•å…ƒæµ‹è¯•</a>ç›¸å…³çš„æ–‡ç« ï¼Œä¹Ÿæœ‰ç”¨åˆ°ã€‚</p>\n<blockquote>\n<p>PhantomJS æ˜¯ä¸€ä¸ªåŸºäº WebKit çš„æœåŠ¡å™¨ç«¯ JavaScript API, æ— éœ€æµè§ˆå™¨çš„æ”¯æŒå³å¯å®ç°å¯¹ Web çš„æ”¯æŒï¼Œ\nä¸”åŸç”Ÿæ”¯æŒå„ç§ Web æ ‡å‡†ï¼Œå¦‚ DOM å¤„ç†ã€JavaScriptã€CSS é€‰æ‹©å™¨ã€JSONã€Canvas å’Œå¯ç¼©æ”¾çŸ¢é‡å›¾å½¢ SVGã€‚</p>\n</blockquote>\n<p>PhantomJS å½¢æˆçš„ä¸€äº›ä¸é”™çš„å¼€æºç”Ÿæ€åœˆå†…å®¹, ç›¸å…³é¡¹ç›®ï¼š</p>\n<ul>\n<li>CasperJSï¼šä¸€ä¸ªå¼€æºçš„å¯¼èˆªè„šæœ¬å¤„ç†å’Œé«˜çº§æµ‹è¯•å·¥å…·</li>\n<li>Poltergeist ï¼šæµ‹è¯•å·¥å…·Capybaraçš„æµ‹è¯•é©±åŠ¨</li>\n<li>Guard::Jasmineï¼šèƒ½å¤ŸåŸºäºRailså®ç°è‡ªåŠ¨åŒ–æµ‹è¯•Jasmineçš„Specs</li>\n<li>GhostDriverï¼šè¿œç¨‹ WebDriver æœ‰çº¿åè®®çš„å¼€æºå®ç°</li>\n<li>PhantomRobotï¼šPhantomJSæœºå™¨äººæµ‹è¯•æ¡†æ¶</li>\n<li>Mocha-PhantomJSï¼šJavaScriptæµ‹è¯•æ¡†æ¶Mochaçš„å®¢æˆ·ç«¯</li>\n</ul>\n<p>ä¸€ä¸ªå®Œæ•´ã€æ´»è·ƒçš„ç”Ÿæ€åœˆæ˜¯é€‰æ‹©ä¸€ä¸ªæ¡†æ¶çš„é‡è¦å‚è€ƒï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯ç›¸æ¯” Vuejs æˆ‘æ›´çœ‹å¥½ Reactjs çš„åŸå› ï¼Œè·‘åäº†â€¦ğŸ˜‚</p>\n<p>CasperJS æ˜¯ä¸€ä¸ªç”¨ JavaScript ç¼–å†™çš„, åŸºäº PhantomJS çš„å¯¼èˆªè„šæœ¬å’Œæµ‹è¯•å·¥å…·,</p>\n<p>å®ƒç®€åŒ–äº†å®šä¹‰ä¸€ä¸ªå®Œæ•´çš„å¯¼èˆªæ“ä½œæ‰€éœ€çš„æ­¥éª¤, è¿˜æä¾›äº†å¾ˆæœ‰ç”¨çš„å‡½æ•°å°è£…ã€æ–¹æ³•å’Œè¯­æ³•ç³–, å®ƒå¯ä»¥å®Œæˆä¸‹é¢è¿™äº›å¸¸è§ä»»åŠ¡:</p>\n<blockquote>\n<ul>\n<li>å®šä¹‰ &#x26; æ’åºæµè§ˆå™¨å¯¼èˆªæ­¥éª¤</li>\n<li>å¡«å…… &#x26; æäº¤è¡¨å•</li>\n<li>ç‚¹å‡» &#x26; è·Ÿè¸ªé“¾æ¥</li>\n<li>æ•è·ç½‘é¡µæˆªå›¾ (è¿˜å¯ä»¥æˆªå–æŸä¸€åŒºåŸŸ)</li>\n<li>åœ¨è¿œç¨‹DOMä¸Šè¿›è¡Œæ–­è¨€æµ‹è¯•</li>\n<li>è®°å½•äº‹ä»¶</li>\n<li>ä¸‹è½½èµ„æº,åŒ…æ‹¬äºŒè¿›åˆ¶æ–‡ä»¶</li>\n<li>ç¼–å†™åŠŸèƒ½æµ‹è¯•å¥—ä»¶,ç»“æœä¿å­˜ä¸ºJUnit XMLæ–‡ä»¶</li>\n<li>æŠ“å–ç½‘é¡µå†…å®¹</li>\n</ul>\n</blockquote>\n<h3 id=\"èµ·å› \"><a href=\"#%E8%B5%B7%E5%9B%A0\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>èµ·å› </h3>\n<p>æœ€åˆçš„æƒ³æ³•æ˜¯æƒ³åšä¸€å¥—å‰ç«¯æµç¨‹æµ‹è¯•ï¼Œæ¯æ¬¡æ‰‹åŠ¨é‡å¤æµ‹è¯•æ€»æ˜¯å¾ˆçƒ¦çš„ï¼Œæµç¨‹æ˜¯è¿™æ ·å­çš„:</p>\n<p><code class=\"language-text\">ç”¨æˆ·ç™»å½• --&gt; é€‰æ‹©å•†å“ --&gt; ä¸‹å• --&gt; è·³è½¬åˆ°æ”¶é“¶å° --&gt; ç¡®è®¤ä»˜æ¬¾</code></p>\n<p>å½“ç„¶è¿™ä¸ªæµç¨‹å¹¶æ²¡æœ‰çœ‹èµ·æ¥è¿™ä¹ˆç®€å•ï¼Œå¿…é¡»è¦æ¨¡æ‹Ÿç”¨æˆ·çš„ç½‘é¡µæ“ä½œï¼Œæ¯”å¦‚ï¼š</p>\n<ol>\n<li>ç™»å½•è¿™æ­¥å¾—è§£å†³éªŒè¯ç é—®é¢˜</li>\n<li>ä¸åŒçš„ä»˜æ¬¾æ–¹å¼ï¼šå¿«æ·æ”¯ä»˜å¾—å‘é€çŸ­ä¿¡ï¼›ä½¿ç”¨æ”¯ä»˜å®äºŒç»´ç ã€å¾®ä¿¡äºŒç»´ç ï¼›ä»¥åŠè·³è½¬åˆ°å…¶ä»–çš„å¹³å°æ”¯ä»˜ç­‰</li>\n</ol>\n<p>ç„¶åä½¿ç”¨ PhantomJS æ¥æ¨¡æ‹Ÿç”¨æˆ·æ“ä½œï¼Œå½“ç„¶å„ç§é—®é¢˜è¿˜åœ¨è§£å†³ä¸­ã€‚</p>\n<p>åœ¨è¯•å›¾è§£å†³é—®é¢˜çš„æ—¶å€™ï¼Œé¦–å…ˆè°ƒç ”äº†ä¸‹ä¸€äº›å‰ç«¯æµ‹è¯•æ¡†æ¶ï¼Œä¸»è¦æ˜¯ UI æµ‹è¯•ã€æµç¨‹æµ‹è¯•æ–¹é¢çš„ï¼Œåšäº†ä¸€äº›å°è¯•ã€‚</p>\n<h3 id=\"èµ·æ‰‹å¼\"><a href=\"#%E8%B5%B7%E6%89%8B%E5%BC%8F\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>èµ·æ‰‹å¼</h3>\n<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹ä¸‹ <a href=\"https://github.com/ariya/phantomjs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PhantomJS</a> çš„ä½¿ç”¨ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> page <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'webpage'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>             <span class=\"token comment\">//æ–°å»ºä¸€ä¸ªé¡µé¢</span>\npage<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>url1<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>                  <span class=\"token comment\">//å¯¼èˆªåˆ°ç¬¬ä¸€ä¸ªURL</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status <span class=\"token operator\">==</span> <span class=\"token string\">\"fail\"</span><span class=\"token punctuation\">)</span> phantom<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>           <span class=\"token comment\">//å¦‚æœå‘ç”Ÿé”™è¯¯,é€€å‡ºç¨‹åº</span>\n    page<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>url2<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>              <span class=\"token comment\">//å¦åˆ™åœ¨é¡µé¢åŠ è½½å®Œæˆçš„å›è°ƒå‡½æ•°ä¸­ç»§ç»­å¯¼èˆªåˆ°ç¬¬äºŒä¸ªURL,ä¾æ¬¡ç±»æ¨</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status <span class=\"token operator\">==</span> <span class=\"token string\">\"fail\"</span><span class=\"token punctuation\">)</span> phantom<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        page<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>url3<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status <span class=\"token operator\">==</span> <span class=\"token string\">\"fail\"</span><span class=\"token punctuation\">)</span> phantom<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n            page<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span>url4<span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status <span class=\"token operator\">==</span> <span class=\"token string\">\"fail\"</span><span class=\"token punctuation\">)</span> phantom<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                <span class=\"token comment\">// æˆ‘å¯ä»¥åœä¸‹æ¥äº†å—?</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>è¿™æ˜¯ä¸€ä¸ªåœ¨ PhantomJS ä¸­ä½¿ç”¨é“¾å¼å›è°ƒæ¥è¿›è¡Œå¯¼èˆªæ“ä½œçš„ä¾‹å­ï¼Œå†™èµ·æ¥ç›¸å½“ç—›è‹¦ã€‚</p>\n<p>æ¯”å¯¹ä¸€ä¸‹ä½¿ç”¨ Casperjs</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> casper <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'casper'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>           <span class=\"token comment\">//æ–°å»ºä¸€ä¸ªé¡µé¢</span>\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span>url1<span class=\"token punctuation\">)</span>                                <span class=\"token comment\">//æ·»åŠ ç¬¬ä¸€ä¸ªURL</span>\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">thenOpen</span><span class=\"token punctuation\">(</span>url2<span class=\"token punctuation\">)</span>                             <span class=\"token comment\">//æ·»åŠ ç¬¬äºŒä¸ªURL,ä¾æ¬¡ç±»æ¨</span>\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">thenOpen</span><span class=\"token punctuation\">(</span>url3<span class=\"token punctuation\">)</span>\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">thenOpen</span><span class=\"token punctuation\">(</span>url4<span class=\"token punctuation\">)</span>\ncasper<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>å¼‚æ­¥æ“ä½œæ›´æ–¹ä¾¿äº†ï¼Œæ›´å¤šçš„ API çœ‹å®˜æ–¹æ–‡æ¡£ <a href=\"http://docs.casperjs.org/en/latest/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://docs.casperjs.org/en/latest/</a> ã€‚</p>\n<h3 id=\"æ­£é¢˜\"><a href=\"#%E6%AD%A3%E9%A2%98\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>æ­£é¢˜</h3>\n<p>ä»¥ä¸Šç®€å•ä»‹ç»äº†ä¸‹ä½¿ç”¨æ–¹æ³•ï¼Œç°åœ¨ä½¿ç”¨ Casperjs æ¥åšç‚¹å®é™…çš„å°è¯•ã€‚</p>\n<p>æ³¨å†Œ github è´¦æˆ·ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> casper <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'casper'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// è¾“å‡ºä¿¡æ¯</span>\n<span class=\"token keyword\">var</span> ca <span class=\"token operator\">=</span> casper<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  verbose<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// å®æ—¶è¾“å‡º</span>\n  logLevel<span class=\"token punctuation\">:</span> <span class=\"token string\">'debug'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// è¾“å‡º dom é¡µé¢æ‰§è¡Œçš„ console ä¿¡æ¯</span>\nca<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'remote.message'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">msg</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">echo</span><span class=\"token punctuation\">(</span>msg<span class=\"token punctuation\">,</span> <span class=\"token string\">'COMMENT'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">var</span> user <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  name<span class=\"token punctuation\">:</span> <span class=\"token string\">'iamrobot1'</span><span class=\"token punctuation\">,</span>\n  email<span class=\"token punctuation\">:</span> <span class=\"token string\">'iamrobot1@gmail.com'</span><span class=\"token punctuation\">,</span> <span class=\"token comment\">// å‡é‚®ç®±</span>\n  password<span class=\"token punctuation\">:</span> <span class=\"token string\">'iamrobot1'</span> <span class=\"token comment\">// å¯†ç éœ€è¦åŒ…å«æ•°å­—</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> signupUrl <span class=\"token operator\">=</span> <span class=\"token string\">'https://github.com/join?source=header-home'</span>\nca<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span>signupUrl<span class=\"token punctuation\">)</span> <span class=\"token comment\">// æ‰“å¼€é¡µé¢</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">thenEvaluate</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">user</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// åŠ è½½å®Œé¡µé¢ï¼Œæ‰§è¡Œ js å¤„ç†è¡¨å•</span>\n    <span class=\"token keyword\">var</span> form <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span>forms<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n    form<span class=\"token punctuation\">[</span><span class=\"token string\">'user[login]'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>name\n    form<span class=\"token punctuation\">[</span><span class=\"token string\">'user[email]'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>email\n    form<span class=\"token punctuation\">[</span><span class=\"token string\">'user[password]'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> user<span class=\"token punctuation\">.</span>password\n    form<span class=\"token punctuation\">.</span><span class=\"token function\">submit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'First, create a new user'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> user<span class=\"token punctuation\">)</span>\n\nca<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'exit'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">echo</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Done!'</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// æ³¨æ„è¿™é‡Œ</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">// å¯åŠ¨</span>\nca<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// æ‰§è¡Œå®Œä»»åŠ¡ï¼Œè®°å¾—é€€å‡º</span>\n  ca<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>ä»¥ä¸Šæµç¨‹å¯ä»¥æ³¨å†Œ github è´¦æˆ·ï¼Œç„¶åæ¥ä¸‹æ¥å°±å¯ä»¥å¹²ç‚¹å…¶ä»–äº‹äº†â€¦</p>\n<p>å½“ç„¶ä¸Šé¢æ–¹å¼åªèƒ½æ³¨å†Œä¸€ä¸ªè´¦æˆ·ï¼Œå½“æˆ‘æƒ³æ³¨å†Œå¤šä¸ªè´¦æˆ·æ—¶ï¼Œå¯ä»¥å†™ä¸€ä¸ªå¾ªç¯ï¼Œç„¶åéšæœºåˆ›å»ºä¿¡æ¯ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">var</span> count <span class=\"token operator\">=</span> <span class=\"token number\">0</span>\n<span class=\"token keyword\">var</span> <span class=\"token function-variable function\">start</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>count <span class=\"token operator\">>=</span> num<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    ca<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    process<span class=\"token punctuation\">.</span><span class=\"token function\">exit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token operator\">...</span><span class=\"token punctuation\">.</span> <span class=\"token comment\">// æ³¨å†Œè¿‡ç¨‹</span>\n\n  ca<span class=\"token punctuation\">.</span><span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    count<span class=\"token operator\">++</span>\n    <span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å› æ­¤ï¼Œå†™äº†ä¸€ä¸ª github çš„è‡ªåŠ¨ star ç¨‹åº <a href=\"https://github.com/xwartz/robot\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">robot</a>ã€‚</p>\n<h4 id=\"åœ¨è¿™è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å‡ ä¸ªå¯ä»¥è®°ä¸€ä¸‹çš„ä¸œè¥¿ï¼š\"><a href=\"#%E5%9C%A8%E8%BF%99%E8%BF%87%E7%A8%8B%E4%B8%AD%EF%BC%8C%E9%81%87%E5%88%B0%E5%87%A0%E4%B8%AA%E5%8F%AF%E4%BB%A5%E8%AE%B0%E4%B8%80%E4%B8%8B%E7%9A%84%E4%B8%9C%E8%A5%BF%EF%BC%9A\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>åœ¨è¿™è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°å‡ ä¸ªå¯ä»¥è®°ä¸€ä¸‹çš„ä¸œè¥¿ï¼š</h4>\n<ol>\n<li>exit æ–¹æ³•æ˜¯ä¸€ä¸ªå¼‚æ­¥çš„è¿‡ç¨‹ã€‚</li>\n<li>start/open æ–¹æ³•æ‰“å¼€æ–°çš„é¡µé¢ï¼Œç±»ä¼¼äºæµè§ˆå™¨æ‰“å¼€æ–°çš„ tabã€‚</li>\n<li>casper.create åªèƒ½åˆ›å»ºä¸€æ¬¡ã€‚</li>\n</ol>\n<p>å…³äºç¬¬ä¸‰ç‚¹æŸ¥çœ‹ <a href=\"http://stackoverflow.com/questions/25883624/declare-two-or-more-casper-in-a-single-script\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Declare two or more casper in a single script</a>ã€‚</p>\n<p>æ‰€ä»¥è¦æ³¨å†Œå¤šä¸ªè´¦æˆ·çš„æ—¶å€™éœ€è¦å…ˆé€€å‡ºç™»å½•ã€‚</p>\n<h4 id=\"ç–‘æƒ‘ï¼š\"><a href=\"#%E7%96%91%E6%83%91%EF%BC%9A\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç–‘æƒ‘ï¼š</h4>\n<ol>\n<li>ç›‘å¬ <code class=\"language-text\">exit</code> äº‹ä»¶ï¼Œæ‰“å¼€å¤šä¸ªé¡µé¢ï¼Œæœ€åä¼šè§¦å‘å¤šæ¬¡</li>\n<li><code class=\"language-text\">waitFor</code> è®¾ç½® <code class=\"language-text\">timeout</code> æ— æ•ˆï¼Œè²Œä¼¼åªèƒ½åœ¨ <code class=\"language-text\">create</code> çš„æ—¶å€™è®¾ç½® <code class=\"language-text\">stepTimeout</code>ï¼Œæˆ–è€…è¯´æ˜¯è¦æ¯” <code class=\"language-text\">stepTimeout</code> å€¼è¦å°ï¼Ÿ</li>\n<li>æ“ä½œæ­¥éª¤å¤šçš„æ—¶å€™ï¼Œä¼šç»å¸¸å‡ºç°è¿™ä¸ªé”™è¯¯ <a href=\"https://github.com/casperjs/casperjs/issues/1689\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Maximum step execution timeout exceeded for step</a></li>\n</ol>\n<h4 id=\"ç¼ºç‚¹\"><a href=\"#%E7%BC%BA%E7%82%B9\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç¼ºç‚¹</h4>\n<ol>\n<li>PhantomJS å¯¹ ES6 æ”¯æŒä¸å‹å¥½ï¼ŒES6 è¯­æ³•ä¹Ÿæ²¡æ³•ä½¿ç”¨</li>\n<li>ä¸èƒ½ require Nodejs çš„ native æ–¹æ³•ï¼Œæ‰€ä»¥ npm å®‰è£…çš„å¾ˆå¤šæ¨¡å—å°±ä¸èƒ½ä½¿ç”¨äº†ï¼Œ<a href=\"http://phantomjs.org/api/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">API æ–‡æ¡£</a></li>\n</ol>\n<h3 id=\"ä¸€äº›ç»éªŒ\"><a href=\"#%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ä¸€äº›ç»éªŒ</h3>\n<ol>\n<li>ä½¿ç”¨ npm å®‰è£… phantomjs-prebuiltï¼Œæ›¿ä»£å…¨å±€å®‰è£… phantomjs</li>\n<li>ä¸æ¨èä½¿ç”¨ phantomjs-node</li>\n<li>æ¨è <a href=\"https://github.com/marak/Faker.js/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">faker.js</a> åˆ›å»ºæ¨¡æ‹Ÿæ•°æ®</li>\n<li>æ¨è<a href=\"https://github.com/ckknight/random-js\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">random-js</a> åˆ›å»ºéšæœºæ•°æ®</li>\n<li>ä¸Šä¼ å›¾ç‰‡æ¥å£ <a href=\"http://phantomjs.org/api/webpage/method/upload-file\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">upload-file</a></li>\n</ol>\n<p>æš‚æ—¶å°±è¿™äº›ã€‚</p>\n<h3 id=\"ç»“è®º\"><a href=\"#%E7%BB%93%E8%AE%BA\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ç»“è®º</h3>\n<p>ä½¿ç”¨ CasperJS/PhantomJS å¯ä»¥åšå¾ˆå¤šè‡ªåŠ¨åŒ–çš„äº‹ï¼Œå€¼å¾—å°è¯•ï¼Œä¸æ€•è¢«è¾â€¦</p>\n<p>æœ€åï¼Œç”¨ Python çš„æœ‹å‹å¯ä»¥çœ‹ä¸‹è¿™ä¸ª <a href=\"http://docs.seattlerb.org/mechanize/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">mechanize</a>ï¼Œç±»ä¼¼ PhantomJS çš„ Python å®ç°ã€‚</p>\n<h3 id=\"èµ„æº\"><a href=\"#%E8%B5%84%E6%BA%90\" aria-hidden class=\"anchor\"><svg aria-hidden=\"true\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>èµ„æº</h3>\n<p><a href=\"http://docs.casperjs.org/en/latest/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">CasperJS</a>\n<a href=\"http://phantomjs.org/documentation/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">PhantomJS</a>\n<a href=\"https://www.npmjs.com/package/phantomjs-prebuilt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">phantomjs-prebuilt</a>\n<a href=\"https://github.com/amir20/phantomjs-node\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">phantomjs-node</a>\n<a href=\"http://www.cnblogs.com/ziyunfei/archive/2012/09/27/2706254.html\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">[è¯‘]CasperJS,åŸºäºPhantomJSçš„å·¥å…·åŒ…</a>\n<a href=\"https://nicolas.perriault.net/code/2012/casperjs-hits-1-0-stable/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Nicolasâ€™s blog</a></p>","timeToRead":9,"frontmatter":{"title":"CasperJS","date":"September 20, 2016","spoiler":"è¿™ä¸æ˜¯ä¸€ç¯‡ä»‹ç»ä½¿ç”¨ CasperJS è¿›è¡Œå•å…ƒæµ‹è¯•çš„æ–‡ç« "},"fields":{"slug":"/casperjs/","langKey":"en"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/casperjs/","previous":{"fields":{"slug":"/redux-source-code-analysis/","langKey":"en","directoryName":"redux-source-code-analysis","maybeAbsoluteLinks":[]},"frontmatter":{"title":"Redux è§£æ"}},"next":{"fields":{"slug":"/start-up-from-new-mac/","langKey":"en","directoryName":"start-up-from-new-mac","maybeAbsoluteLinks":[]},"frontmatter":{"title":"é‡æ¥ï¼šæ­å»ºå¼€å‘ç¯å¢ƒ"}},"translations":[],"translatedLinks":[]}}}